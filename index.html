<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Document</title>
	</head>
	<body>
		<h1>Color simulation of elderly vision</h1>

		<input type="file" id="file" accept="image/*" />

		<h2>Input Image</h2>

		<image id="InputImage" />

		<h2>Output Image</h2>
		<canvas id="OutputImage"> </canvas>
	</body>
	<script src="ColorAger.js"></script>
	<script>
		const file = document.getElementById("file")
		const inputImage = document.getElementById("InputImage")

		file.addEventListener("change", (e) => {
			const reader = new FileReader()
			reader.onload = () => {
				//show input image
				inputImage.src = reader.result

				//to ImageData instance
				const canvas = document.createElement("canvas")
				const ctx = canvas.getContext("2d")
				const image = new Image()
				image.src = reader.result
				image.onload = () => {
					canvas.width = image.width
					canvas.height = image.height
					ctx.drawImage(image, 0, 0)
					const imageData = ctx.getImageData(0, 0, image.width, image.height)

					//color aging
					const agedImage = AgeImage(imageData, 60)

					//to canvas
					const outputImage = document.getElementById("OutputImage")
					outputImage.width = agedImage.width
					outputImage.height = agedImage.height
					const outputCtx = outputImage.getContext("2d")
					outputCtx.putImageData(agedImage, 0, 0)
				}
			}
			reader.readAsDataURL(e.target.files[0])
		})
	</script>
</html>
